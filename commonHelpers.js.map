{"version":3,"file":"commonHelpers.js","sources":["../src/utils.js","../src/pixabay-api.js","../src/index.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst isWhitespacesOrEmpty = input => {\n  const regexPattern = /[^ \\t\\r\\n\\v\\f]/;\n  return !regexPattern.test(input);\n};\n\nfunction displaySuccess(message, title = '') {\n  iziToast.success({\n    title,\n    message,\n  });\n}\n\nfunction displayError(message, title = '') {\n  iziToast.error({\n    title,\n    message,\n  });\n}\n\nfunction displayWarning(message, title = '') {\n  iziToast.warning({\n    title,\n    message,\n  });\n}\n\nfunction displayInfo(message, title = '') {\n  iziToast.info({\n    title,\n    message,\n  });\n}\n\nclass HideableElement {\n  constructor(element, visibleClass, hiddenClass = 'hidden') {\n    this.elementInstance = element;\n    this.visibleClass = visibleClass;\n    this.hiddenClass = hiddenClass;\n  }\n\n  show() {\n    this.elementInstance.classList.replace(this.hiddenClass, this.visibleClass);\n  }\n\n  hide() {\n    this.elementInstance.classList.replace(this.visibleClass, this.hiddenClass);\n  }\n\n  get element() {\n    return this.elementInstance;\n  }\n}\n\nexport {\n  isWhitespacesOrEmpty,\n  displaySuccess,\n  displayError,\n  displayWarning,\n  displayInfo,\n  HideableElement,\n};\n","import axios from 'axios';\n\nconst API_KEY = '40870788-52c67d6ee188ca20694b5c2b3';\naxios.defaults.baseURL = 'https://pixabay.com/api';\naxios.defaults.timeout = 3000;\n\nconst axiosInstance = axios.create();\n\nasync function requestImages(query, page = 1, perPage = 20) {\n  const data = await axiosInstance.get('/', {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page: perPage,\n    },\n  });\n\n  return data;\n}\n\nexport { requestImages };\n","import {\n  isWhitespacesOrEmpty,\n  displayWarning,\n  displayInfo,\n  HideableElement,\n} from './utils.js';\nimport { requestImages } from './pixabay-api.js';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst refs = {\n  form: document.querySelector('.search-form'),\n  loader: new HideableElement(document.querySelector('.loader'), 'loader'),\n  gallery: document.querySelector('.gallery'),\n  loadMoreBtn: new HideableElement(\n    document.querySelector('.load-more'),\n    'load-more'\n  ),\n  pageEnd: document.querySelector('.js-page-end'),\n};\n\nconst gallery = new SimpleLightbox('.gallery .gallery__link', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  captionPosition: 'bottom',\n});\n\nconst imagesPerPage = 40;\nlet searchQuery;\nlet currentPage = 0;\n\nrefs.loadMoreBtn.hide();\nrefs.loader.hide();\n\nrefs.form.addEventListener('submit', onSearchSubmit);\nrefs.loadMoreBtn.element.addEventListener('click', () =>\n  fetchImages(searchQuery)\n);\n\nconst observer = new MutationObserver(() => {\n  if (currentPage > 1) {\n    setTimeout(scrollGallerySmooth, 700);\n  }\n});\n\nconst mutationObserverConfig = { childList: true };\nobserver.observe(refs.gallery, mutationObserverConfig);\n\nfunction onSearchSubmit(evt) {\n  evt.preventDefault();\n\n  const form = evt.currentTarget;\n  const formData = new FormData(form);\n  searchQuery = formData.get('searchQuery');\n  // form.reset();\n\n  if (isWhitespacesOrEmpty(searchQuery)) {\n    displayWarning('Enter something');\n    return;\n  }\n\n  currentPage = 0;\n  clearGallery();\n  fetchImages(searchQuery);\n}\n\nasync function fetchImages(query) {\n  try {\n    refs.loader.show();\n    refs.loadMoreBtn.hide();\n    currentPage += 1;\n    const response = await requestImages(query, currentPage, imagesPerPage);\n\n    const images = response.data.hits;\n    const totalImages = response.data.totalHits;\n\n    if (images.length === 0) {\n      displayInfo(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n      return;\n    }\n\n    renderImages(images);\n    gallery.refresh();\n\n    if (currentPage === 1) {\n      displayInfo(`Hooray! We found ${totalImages} images.`);\n    }\n\n    if (\n      images.length < imagesPerPage ||\n      currentPage * imagesPerPage >= totalImages\n    ) {\n      refs.loadMoreBtn.hide();\n      displayInfo(\"We're sorry, but you've reached the end of search results.\");\n      return;\n    }\n\n    refs.loadMoreBtn.show();\n  } catch (error) {\n    console.log(error);\n  } finally {\n    refs.loader.hide();\n  }\n}\n\nfunction renderImages(images) {\n  const markup = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<div class=\"photo-card\">\n            <a class=\"gallery__link\" href=\"${largeImageURL}\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n            </a>\n            <div class=\"info\">\n              <p class=\"info-item\">\n                  <b>Likes</b>\n                  ${likes}\n              </p>\n              <p class=\"info-item\">\n                  <b>Views</b>\n                  ${views}\n              </p>\n              <p class=\"info-item\">\n                  <b>Comments</b>\n                  ${comments}\n              </p>\n              <p class=\"info-item\">\n            <b>Downloads</b>\n            ${downloads}\n              </p>\n            </div>\n       </div>`\n    )\n    .join('');\n\n  refs.gallery.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction scrollGallerySmooth() {\n  const { height: cardHeight } =\n    refs.gallery.firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction clearGallery() {\n  refs.gallery.innerHTML = '';\n}\n"],"names":["isWhitespacesOrEmpty","input","displayWarning","message","title","iziToast","displayInfo","HideableElement","element","visibleClass","hiddenClass","API_KEY","axios","axiosInstance","requestImages","query","page","perPage","refs","gallery","SimpleLightbox","imagesPerPage","searchQuery","currentPage","onSearchSubmit","fetchImages","observer","scrollGallerySmooth","mutationObserverConfig","evt","form","clearGallery","response","images","totalImages","renderImages","error","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","cardHeight"],"mappings":"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"}